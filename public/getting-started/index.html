<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="description" content="">
    <meta name="author" content="">

    <title>gb</title>

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">

    
    <link href="/css/jumbotron-narrow.css" rel="stylesheet">

  </head>

  <body>
    <div class="container">
      <div class="header clearfix">
        <nav>
          <ul class="nav nav-pills pull-right">
            <li role="presentation" class="active"><a href="/">Home</a></li>
            <li role="presentation"><a href="/about">About</a></li>
            <li role="presentation"><a href="/docs/install">Installation</a></li>
            <li role="presentation"><a href="/docs/usage">Usage</a></li>
            <li role="presentation"><a href="/faq">FAQ</a></li>
            <li role="presentation"><a href="https://github.com/constabulary/gb">Contribute</a></li>
          </ul>
        </nav>
      </div>




<h1 id="getting-started:b6885e1f85551f51a4707c402f8200a3">Getting started</h1>

<p>This document is a guide to introduce people to the <code>gb</code> project structure. A <code>gb</code> project is conceptually a <code>$GOPATH</code> per project, but saying that doesn&rsquo;t really help explain how to set up a new project; hence this document.</p>

<h1 id="creating-an-empty-project:b6885e1f85551f51a4707c402f8200a3">Creating an empty project</h1>

<p>A <code>gb</code> project is defined as any directory that has a <code>src/</code> subdirectory. The simplest possible <code>gb</code> project would be</p>

<pre><code> % mkdir -p ~/project/src/
 % cd ~/project
</code></pre>

<p><code>~/project</code> is therefore a <code>gb</code> project.</p>

<p>Source inside a <code>gb</code> project follows the same rules as the <code>go</code> tool, see the <a href="https://golang.org/doc/code.html#Workspaces">Workspaces section of the Go getting started document</a>. All Go code goes in packages, and packages are subdirectories inside the project&rsquo;s <code>src/</code> directory</p>

<pre><code> % cd ~/project
 % mkdir -p src/cmd/helloworld
 % cat &lt;&lt;EOF &gt; src/cmd/helloworld/helloworld.go
 package main

 import &quot;fmt&quot;

 func main() {
         fmt.Println(&quot;Hello world&quot;)
 }
 EOF
 % gb build cmd/helloworld
</code></pre>

<p>will build the small <code>helloworld</code> command.</p>

<h1 id="converting-an-existing-project:b6885e1f85551f51a4707c402f8200a3">Converting an existing project</h1>

<p>This section shows how to construct a <code>gb</code> project using existing code bases.</p>

<h2 id="simple-example:b6885e1f85551f51a4707c402f8200a3">Simple example</h2>

<p>In this example we&rsquo;ll create a <code>gb</code> project from the <code>github.com/pkg/sftp</code> codebase.</p>

<p>First, create a project,</p>

<pre><code> % mkdir -p ~/devel/sftp
 % cd ~/devel/sftp
</code></pre>

<p>Now checkout <code>github.com/pkg/sftp</code> to the path it expects</p>

<pre><code> % mkdir -p src/github.com/pkg/sftp
 % git clone https://github.com/pkg/sftp src/github.com/pkg/sftp
</code></pre>

<p>Now, let&rsquo;s try to build this</p>

<pre><code> % gb build all
 2015/04/29 13:39:44 INFO project root &quot;/home/dfc/devel/sftp&quot;
 2015/04/29 13:39:44 INFO build duration: 486.967µs map[]
 2015/04/29 13:39:44 command &quot;build&quot; failed: failed to resolve package &quot;github.com/pkg/sftp&quot;: cannot find package &quot;github.com/kr/fs&quot; in any of:
         /home/dfc/go/src/github.com/kr/fs (from $GOROOT)
         /home/dfc/devel/sftp/src/github.com/kr/fs (from $GOPATH)
         /home/dfc/devel/sftp/vendor/src/github.com/kr/fs
</code></pre>

<p>The build failed because the dependency, <code>github.com/kr/fs</code> was not found in the project, which was expected (ignore the message about <code>$GOPATH</code> this is a side effect of reusing the <code>go/build</code> package for dependency resolution). So we can use the <code>gb vendor</code> plugin to fetch the code for <code>github.com/kr/fs</code>, and try again</p>

<pre><code> % gb vendor github.com/kr/fs
 2015/04/29 13:42:02 INFO project root &quot;/home/dfc/devel/sftp&quot;
 % gb build all                                                                                                                   
 2015/04/29 13:42:06 INFO project root &quot;/home/dfc/devel/sftp&quot;
 2015/04/29 13:42:06 INFO build duration: 701.994µs map[]
 2015/04/29 13:42:06 command &quot;build&quot; failed: failed to resolve package &quot;github.com/pkg/sftp&quot;: cannot find package &quot;golang.org/x/crypto/ssh&quot; in any of:
         /home/dfc/go/src/golang.org/x/crypto/ssh (from $GOROOT)
         /home/dfc/devel/sftp/src/golang.org/x/crypto/ssh (from $GOPATH)
         /home/dfc/devel/sftp/vendor/src/golang.org/x/crypto/ssh
</code></pre>

<p>Nearly, there, just missing the <code>golang.org/x/crypto/ssh</code> package, again we&rsquo;ll use <code>gb vendor</code>.</p>

<pre><code>  % gb vendor golang.org/x/crypto/ssh
 2015/04/29 13:44:32 INFO project root &quot;/home/dfc/devel/sftp&quot;
  % gb build all                                                                                                                   
 2015/04/29 13:44:40 INFO project root &quot;/home/dfc/devel/sftp&quot;
 2015/04/29 13:44:40 INFO compile github.com/kr/fs [filesystem.go walk.go]
 2015/04/29 13:44:40 INFO compile golang.org/x/crypto/ssh [buffer.go certs.go channel.go cipher.go client.go client_auth.go common.go connection.go doc.go handshake.go kex.go keys.go mac.go messages.go mux.go server.go session.go tcpip.go transport.go]
 2015/04/29 13:44:40 INFO install compile {fs github.com/kr/fs /home/dfc/devel/sftp/vendor/src/github.com/kr/fs}
 2015/04/29 13:44:41 INFO install compile {ssh golang.org/x/crypto/ssh /home/dfc/devel/sftp/vendor/src/golang.org/x/crypto/ssh}
 2015/04/29 13:44:41 INFO compile golang.org/x/crypto/ssh/agent [client.go forward.go keyring.go server.go]
 2015/04/29 13:44:41 INFO compile github.com/pkg/sftp [attrs.go client.go packet.go release.go sftp.go]
 2015/04/29 13:44:42 INFO install compile {agent golang.org/x/crypto/ssh/agent /home/dfc/devel/sftp/vendor/src/golang.org/x/crypto/ssh/agent}
 2015/04/29 19:50:55 INFO compile github.com/pkg/sftp/examples/buffered-read-benchmark [main.go]
 2015/04/29 19:50:55 INFO compile github.com/pkg/sftp/examples/buffered-write-benchmark [main.go]
 2015/04/29 19:50:55 INFO compile github.com/pkg/sftp/examples/gsftp [main.go]
 2015/04/29 19:50:55 INFO compile github.com/pkg/sftp/examples/streaming-read-benchmark [main.go]
 2015/04/29 19:50:55 INFO compile github.com/pkg/sftp/examples/streaming-write-benchmark [main.go]
 2015/04/29 19:50:56 INFO link /home/dfc/devel/sftp/bin/buffered-read-benchmark [/tmp/gb786934546/github.com/pkg/sftp/examples/buffered-read-benchmark/main.a]
 2015/04/29 19:50:56 INFO link /home/dfc/devel/sftp/bin/gsftp [/tmp/gb786934546/github.com/pkg/sftp/examples/gsftp/main.a]
 2015/04/29 19:50:56 INFO link /home/dfc/devel/sftp/bin/streaming-read-benchmark [/tmp/gb786934546/github.com/pkg/sftp/examples/streaming-read-benchmark/main.a]
 2015/04/29 19:50:56 INFO link /home/dfc/devel/sftp/bin/streaming-write-benchmark [/tmp/gb786934546/github.com/pkg/sftp/examples/streaming-write-benchmark/main.a]
 2015/04/29 19:50:56 INFO link /home/dfc/devel/sftp/bin/buffered-write-benchmark [/tmp/gb786934546/github.com/pkg/sftp/examples/buffered-write-benchmark/main.a]
 2015/04/29 19:50:58 INFO build duration: 2.535541868s map[compile:1.895628229s link:9.827128875s]
</code></pre>

<p>And now it builds. Some things to note</p>

<ul>
<li>The package name <code>all</code> matches all the packages inside your project&rsquo;s <code>src/</code> directory. It&rsquo;s a simple way to build everything, you can use other import paths and globs.</li>
<li>There is no way to build your vendored source, it will be built if required to build your code in the <code>src/</code> directory.</li>
</ul>

<h2 id="more-complicated-example:b6885e1f85551f51a4707c402f8200a3">More complicated example</h2>

<p>For the second example we&rsquo;ll take a project that uses <code>godep</code> vendoring and convert it to be a <code>gb</code> project. First we&rsquo;ll need to setup a project and get the source</p>

<pre><code> % mkdir -p ~/devel/confd
 % cd ~/devel/confd
 % mkdir -p src/github.com/kelseyhightower/confd
 % git clone https://github.com/kelseyhightower/confd src/github.com/kelseyhightower/confd  
</code></pre>

<p>Now, we know this project uses <code>godeps</code>, so already includes all its dependencies, so we just need to rearrange things a bit.</p>

<pre><code> % mkdir -p vendor/src/
 % mv src/github.com/kelseyhightower/confd/Godeps/_workspace/src/* vendor/src/
</code></pre>

<p>Let&rsquo;s see if it builds</p>

<pre><code> % gb build all
 2015/04/29 19:52:16 INFO project root &quot;/home/dfc/devel/confd&quot;
 2015/04/29 19:52:16 INFO compile github.com/kelseyhightower/confd [confd.go config.go node_var.go version.go]
 2015/04/29 19:52:16 INFO compile github.com/kelseyhightower/confd/integration/zookeeper [main.go]
 2015/04/29 19:52:16 INFO link /home/dfc/devel/confd/bin/zookeeper [/tmp/gb934182157/github.com/kelseyhightower/confd/integration/zookeeper/main.a]
 2015/04/29 19:52:16 INFO link /home/dfc/devel/confd/bin/confd [/tmp/gb934182157/github.com/kelseyhightower/confd/main.a]
 2015/04/29 19:52:17 INFO build duration: 1.7575955s map[compile:405.681764ms link:2.275663206s]
</code></pre>

<p>And it does.</p>

<h1 id="wrapping-up:b6885e1f85551f51a4707c402f8200a3">Wrapping up</h1>

<p>Setting up, or converting code to a <code>gb</code> project is simple. Once you&rsquo;re done, just check the whole project into your source control.</p>


      <footer class="footer">
  <ul>
    
      <div class="row">
        <ul>
          
          <div class="col-md-4">
          <p> design </p>
                <ul>
                
                    <li hugo-nav="/about/"><a href="http://localhost:1313/about/"> About gb </a> </li>
                
                </ul>
          </div>
          
          <div class="col-md-4">
          <p> docs </p>
                <ul>
                
                    <li hugo-nav="/docs/install/"><a href="http://localhost:1313/docs/install/"> Installation </a> </li>
                
                    <li hugo-nav="/docs/project/"><a href="http://localhost:1313/docs/project/"> Project </a> </li>
                
                    <li hugo-nav="/docs/usage/"><a href="http://localhost:1313/docs/usage/"> Usage </a> </li>
                
                </ul>
          </div>
          
          <div class="col-md-4">
          <p> plugins </p>
                <ul>
                
                    <li hugo-nav="/plugins/gb-env/"><a href="http://localhost:1313/plugins/gb-env/"> gb-env </a> </li>
                
                    <li hugo-nav="/plugins/gb-vendor/"><a href="http://localhost:1313/plugins/gb-vendor/"> gb-vendor </a> </li>
                
                </ul>
          </div>
          
        </ul>
      </div>
    
      <div class="row">
        <ul>
          
        </ul>
      </div>
    
  </ul>
        <p class="text-center"><em>gb</em> is developed by the <a href="https://github.com/constabulary">Constabulary</a> | This website is proudly built with <a href="https://gohugo.io/">hugo</a></p>
      </footer>

    </div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-18618646-5', 'auto');
  ga('send', 'pageview');

</script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
  <script>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>

